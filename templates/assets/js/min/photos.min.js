(function(){$(document).ready(function(){let e=$(`#image-grid`).isotope({itemSelector:`.grid-item`,percentPosition:!0,masonry:{columnWidth:`.grid-item`}}),t=Number(document.querySelector(`#image-grid`).getAttribute(`data-index`))+1,n=document.querySelector(`#image-grid`).getAttribute(`data-total`),r=ThemeConfig.blog_url,i=document.querySelector(`.joe_loading`);function a(){let t=document.querySelectorAll(`.grid-item`),n=new IntersectionObserver(function(t,n){t.forEach(function(t){if(t.isIntersecting){let r=t.target.querySelector(`.lazy-load`);r&&(r.src=r.dataset.src,r.classList.remove(`lazy-load`),n.unobserve(t.target),r.onload=function(){e.isotope(`layout`)})}})},{threshold:.5});t.forEach(function(e){n.observe(e)})}a();let o=async function(){let i=r+`/photos/page/`+t;if(t>n){document.querySelector(`.joe_loading`).remove();return}fetch(i).then(e=>e.text()).then(r=>{let i=new DOMParser().parseFromString(r,`text/html`).querySelectorAll(`.grid-item`);i.length>0&&(i.forEach(t=>{e.append(t).isotope(`appended`,t)}),e.isotope(`layout`),a(),t++,t>n&&document.querySelector(`.joe_loading`).remove())}).catch(e=>{console.error(`Error fetching next page data:`,e)})};new IntersectionObserver(e=>{e[0].isIntersecting&&o()},{threshold:1}).observe(i),$(`.joe_photos__filter li`).on(`click`,function(){let t=$(this).attr(`data-sjslink`);$(this).addClass(`active`).siblings().removeClass(`active`),e.isotope({filter:function(){let e=$(this).attr(`data-sjsel`);return t===`*`||e===t}})})})})();